varnishtest "startswith and endswith ban operators"

##### startswith

server s1 {
	rxreq
	expect req.url == "a.ahello"
	txresp
	rxreq
	expect req.url == "aaahello"
	txresp
	rxreq
	expect req.url == "a.ahello"
	txresp
} -start

varnish v1 -vcl+backend {} -start

client c1 {
	txreq -url "a.ahello"
	rxresp
	txreq -url "aaahello"
	rxresp
} -run

varnish v1 -cliok {ban req.url startswith "a.a"}

client c1 {
	txreq -url "aaahello"
	rxresp
	txreq -url "a.ahello"
	rxresp
} -run

#server s1 -wait

##### endswith

server s1 {
	rxreq
	expect req.url == "helloa.a"
	txresp
	rxreq
	expect req.url == "helloaaa"
	txresp
	rxreq
	expect req.url == "helloa.a"
	txresp
}

client c1 {
	txreq -url "helloa.a"
	rxresp
	txreq -url "helloaaa"
	rxresp
} -run

varnish v1 -cliok {ban req.url endswith "a.a"}

client c1 {
	txreq -url "helloaaa"
	rxresp
	txreq -url "helloa.a"
	rxresp
} -run

server s1 -wait
